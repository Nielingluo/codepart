var gulp=require("gulp"),uglify=require("gulp-uglify"),concat=require("gulp-concat"),imagemin=require("gulp-imagemin"),tinypng=require("gulp-tinypng"),tiny=require("gulp-tinypng-nokey"),cleanCSS=require("gulp-clean-css"),less=require("gulp-less"),sourcemaps=require("gulp-sourcemaps"),watchPath=require("gulp-watch-path"),rename=require("gulp-rename"),spritesmith=require("gulp.spritesmith");gulp.task("firstScript",function(){gulp.src("script/*.js").pipe(uglify()).pipe(rename({suffix:".min"})).pipe(gulp.dest("newScript"))}),gulp.task("auto",function(){gulp.watch("script/*.js",function(p){var e=watchPath(p,"script","newScript");gulp.src(e.srcPath).pipe(uglify()).pipe(rename({suffix:".min"})).pipe(gulp.dest(e.distDir))}),gulp.watch("script/*.js",function(){gulp.src("script/*.js").pipe(concat("main.js")).pipe(gulp.dest("newScript")).pipe(rename({suffix:".min"})).pipe(uglify()).pipe(gulp.dest("newScript"))}),gulp.watch("images/*.{jpg,png,jpeg}",function(p){var e=watchPath(p,"images","newImages");gulp.src(e.srcPath).pipe(tiny()).pipe(rename({suffix:".min"})).pipe(gulp.dest(e.distDir))}),gulp.watch("css/*.css",function(p){var e=watchPath(p,"css","newCss");gulp.src(e.srcPath).pipe(cleanCSS({compatibility:"ie8"})).pipe(rename({suffix:".mini"})).pipe(gulp.dest(e.distDir))}),gulp.watch("../less/less/*.less",function(p){var e=watchPath(p,"less","css");gulp.src(e.srcPath).pipe(less()).pipe(gulp.dest("../less/css"))})}),gulp.task("minifyjs",function(){return gulp.src("script/*.js").pipe(concat("main.js")).pipe(gulp.dest("Js")).pipe(rename({suffix:".min"})).pipe(uglify()).pipe(gulp.dest("Js"))}),gulp.task("minicss",function(){gulp.src("css/*.css").pipe(cleanCSS({compatibility:"ie8"})).pipe(rename({suffix:".min"})).pipe(gulp.dest("MiniCSS"))}),gulp.task("less",function(){gulp.src("less/*.less").pipe(less()).pipe(gulp.dest("dist"))}),gulp.task("sourcemaps",function(){gulp.src("less/*.less").pipe(sourcemaps.init()).pipe(less()).pipe(sourcemaps.write("./maps")).pipe(gulp.dest("./public/css"))}),gulp.task("minImages",function(){gulp.src("images/*.jpg").pipe(imagemin({optimizationLevel:7})).pipe(rename({suffix:".mini"})).pipe(gulp.dest("newImages"))}),gulp.task("tinypng",function(){gulp.src("images/*.png").pipe(tinypng("DrnyIjlygw6KqfExVG-GOW0nC74frl5C")).pipe(gulp.dest("newImages/compressed_images"))}),gulp.task("nokey",function(p){gulp.src("images/*").pipe(tiny()).pipe(gulp.dest("newImages/nokey"))}),gulp.task("sprite",function(){return gulp.src("images/icon/*.png").pipe(spritesmith({imgName:"sprite.png",cssName:"sprite.css"})).pipe(gulp.dest("output"))}),gulp.task("default",["auto"]);